<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Architecture Visualization</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network@latest/dist/vis-network.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #333;
            margin: 0;
            font-size: 2em;
        }
        .controls-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .control-section {
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .control-section h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 1.1em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }
        .control-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .control-row:last-child {
            margin-bottom: 0;
        }
        .control-row label {
            font-weight: bold;
            color: #555;
            min-width: 120px;
        }
        .control-row input[type="range"] {
            flex: 1;
            margin: 0 10px;
        }
        .control-row input[type="number"] {
            width: 60px;
            padding: 2px 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        .control-row select, .control-row button {
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            background-color: white;
            min-width: 100px;
        }
        .control-row button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            border: none;
        }
        .control-row button:hover {
            background-color: #0056b3;
        }
        .control-row button.active {
            background-color: #28a745;
        }
        .navigation-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        .navigation-controls button {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 3px;
            background-color: #f8f9fa;
            cursor: pointer;
        }
        .navigation-controls button:hover {
            background-color: #e9ecef;
        }
        .network-container {
            width: 100%;
            height: 70vh;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #fafafa;
            position: relative;
        }
        .zoom-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 1000;
        }
        .zoom-controls button {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
        }
        .zoom-controls button:hover {
            background-color: rgba(240, 240, 240, 0.9);
        }
        .physics-status {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            font-size: 12px;
            z-index: 1000;
        }
        .legend {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .legend h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .legend-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 2px solid #333;
        }
        .footer {
            margin-top: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
        .stats {
            margin-top: 10px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
        @media (max-width: 768px) {
            .controls-panel {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Complete Architecture Visualization</h1>
            <p>Enhanced Interactive Architecture Visualization with Physics Controls</p>
        </div>
        
        <div class="controls-panel">
            <div class="control-section">
                <h3>üéÆ Navigation & Layout</h3>
                <div class="navigation-controls">
                    <button onclick="fitNetwork()">üìê Fit Screen</button>
                    <button onclick="resetZoom()">üîç Reset Zoom</button>
                    <button onclick="centerNetwork()">üéØ Center</button>
                    <button onclick="togglePhysics()" id="physics-toggle">‚ö° Physics ON</button>
                </div>
                <div class="control-row">
                    <label for="layout-select">Layout Type:</label>
                    <select id="layout-select">
                        <option value="forceAtlas2Based">Force Atlas 2</option>
                        <option value="barnesHut">Barnes Hut</option>
                        <option value="repulsion">Repulsion</option>
                        <option value="hierarchicalUD">Hierarchical ‚Üï</option>
                        <option value="hierarchicalLR">Hierarchical ‚Üî</option>
                    </select>
                </div>
                <div class="control-row">
                    <label for="solver-select">Physics Solver:</label>
                    <select id="solver-select">
                        <option value="forceAtlas2Based">Force Atlas 2</option>
                        <option value="barnesHut">Barnes Hut</option>
                        <option value="repulsion">Repulsion</option>
                        <option value="hierarchicalRepulsion">Hierarchical</option>
                    </select>
                </div>
            </div>

            <div class="control-section">
                <h3>‚öôÔ∏è Physics Parameters</h3>
                <div class="control-row">
                    <label for="gravity-slider">Central Gravity:</label>
                    <input type="range" id="gravity-slider" min="0" max="2" step="0.1" value="0.3">
                    <input type="number" id="gravity-value" min="0" max="2" step="0.1" value="0.3">
                </div>
                <div class="control-row">
                    <label for="spring-length-slider">Spring Length:</label>
                    <input type="range" id="spring-length-slider" min="50" max="500" step="10" value="100">
                    <input type="number" id="spring-length-value" min="50" max="500" step="10" value="100">
                </div>
                <div class="control-row">
                    <label for="spring-constant-slider">Spring Strength:</label>
                    <input type="range" id="spring-constant-slider" min="0.01" max="0.5" step="0.01" value="0.08">
                    <input type="number" id="spring-constant-value" min="0.01" max="0.5" step="0.01" value="0.08">
                </div>
                <div class="control-row">
                    <label for="node-distance-slider">Node Distance:</label>
                    <input type="range" id="node-distance-slider" min="50" max="300" step="10" value="120">
                    <input type="number" id="node-distance-value" min="50" max="300" step="10" value="120">
                </div>
                <div class="control-row">
                    <label for="damping-slider">Damping:</label>
                    <input type="range" id="damping-slider" min="0.01" max="0.99" step="0.01" value="0.09">
                    <input type="number" id="damping-value" min="0.01" max="0.99" step="0.01" value="0.09">
                </div>
            </div>
        </div>
        
        <div class="network-container">
            <div id="network" style="width: 100%; height: 100%;"></div>
            <div class="zoom-controls">
                <button onclick="zoomIn()" title="Zoom In">+</button>
                <button onclick="zoomOut()" title="Zoom Out">‚àí</button>
                <button onclick="fitNetwork()" title="Fit to Screen">‚åÇ</button>
            </div>
            <div class="physics-status" id="physics-status">
                Physics: <span id="physics-state">Enabled</span> | 
                Nodes: 45 | 
                Edges: 59
            </div>
        </div>
        
        <div class="legend">
            <h3>Entity Types</h3>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #afa; border-color: #3a3;"></div>
                    <span>Application Components</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #7d7; border-color: #3a3;"></div>
                    <span>Core Functions</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #bbf; border-color: #33f;"></div>
                    <span>Framework Components</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #f9f; border-color: #333;"></div>
                    <span>Database Tables</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #fbb; border-color: #d33;"></div>
                    <span>Database Functions</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #f9f9f9; border-color: #999;"></div>
                    <span>Data Flow Elements</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ffd; border-color: #aa3;"></div>
                    <span>Command Arguments</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ffb; border-color: #b90;"></div>
                    <span>Selected Components</span>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Interactive network diagram powered by vis.js | 
            Use mouse to drag nodes and pan view | Scroll to zoom | 
            Adjust physics parameters in real-time</p>
        </div>
    </div>

    <script type="text/javascript">
        // Network data
        var nodes = new vis.DataSet([
        {
                "id": "n_1_inits_configuration",
                "label": "1. inits configuration",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "1. inits configuration (data_flow_elements)",
                "size": 12
        },
        {
                "id": "PromptBuilder",
                "label": "PromptBuilder",
                "color": {
                        "background": "#bbf",
                        "border": "#33f"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "PromptBuilder (framework_components)",
                "size": 25
        },
        {
                "id": "model_alias",
                "label": "--model_alias",
                "color": {
                        "background": "#ffd",
                        "border": "#aa3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "--model_alias (command_arguments)",
                "size": 14
        },
        {
                "id": "CasesBench_br_Input_cases",
                "label": "CasesBench\n(Input cases)",
                "color": {
                        "background": "#f9f",
                        "border": "#333"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "CasesBench<br/>(Input cases) (database_tables)",
                "size": 25
        },
        {
                "id": "Differential_Diagnosis_ID",
                "label": "Differential Diagnosis ID",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Differential Diagnosis ID (data_flow_elements)",
                "size": 12
        },
        {
                "id": "add_batch_differential_diagnoses_br_in_dxGPT_queries",
                "label": "add_batch_differential_diagnoses()\nin dxGPT_queries",
                "color": {
                        "background": "#fbb",
                        "border": "#d33"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "add_batch_differential_diagnoses()<br/>in dxGPT_queries (database_functions)",
                "size": 20
        },
        {
                "id": "Reasoning_br_String",
                "label": "Reasoning\n(String)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Reasoning<br/>(String) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "queries_dxGPT_queries_py_br_Database_operations",
                "label": "queries/dxGPT_queries.py\n(Database operations)",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "queries/dxGPT_queries.py<br/>(Database operations) (application_components)",
                "size": 20
        },
        {
                "id": "prompt_id",
                "label": "prompt_id",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "prompt_id (data_flow_elements)",
                "size": 12
        },
        {
                "id": "List_of_Clinical_Cases_w_DDx_br_Pydantic_Models",
                "label": "List of Clinical Cases w/ DDx\n(Pydantic Models)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "List of Clinical Cases w/ DDx<br/>(Pydantic Models) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "process_results",
                "label": "process_results()",
                "color": {
                        "background": "#7d7",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "process_results() (core_functions)",
                "size": 30
        },
        {
                "id": "prompt_alias",
                "label": "--prompt_alias",
                "color": {
                        "background": "#ffd",
                        "border": "#aa3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "--prompt_alias (command_arguments)",
                "size": 14
        },
        {
                "id": "List_of_Clinical_Cases_br_Pydantic_models",
                "label": "List of Clinical Cases\n(Pydantic models)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "List of Clinical Cases<br/>(Pydantic models) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "List_of_LLM_responses_br_plain_text",
                "label": "List of LLM responses\n(plain text)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "List of LLM responses<br/>(plain text) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "Prompts_br_Templates",
                "label": "Prompts\n(Templates)",
                "color": {
                        "background": "#f9f",
                        "border": "#333"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Prompts<br/>(Templates) (database_tables)",
                "size": 25
        },
        {
                "id": "model_id",
                "label": "model_id",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "model_id (data_flow_elements)",
                "size": 12
        },
        {
                "id": "insert_or_fetch_model_br_insert_or_fetch_prompt",
                "label": "insert_or_fetch_model()\ninsert_or_fetch_prompt()",
                "color": {
                        "background": "#fbb",
                        "border": "#d33"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "insert_or_fetch_model()<br/>insert_or_fetch_prompt() (database_functions)",
                "size": 20
        },
        {
                "id": "Models_br_LLM_configs",
                "label": "Models\n(LLM configs)",
                "color": {
                        "background": "#f9f",
                        "border": "#333"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Models<br/>(LLM configs) (database_tables)",
                "size": 25
        },
        {
                "id": "dxGPT_async_py_br_Main_async_workflow",
                "label": "dxGPT_async.py\n(Main async workflow)",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "dxGPT_async.py<br/>(Main async workflow) (application_components)",
                "size": 20
        },
        {
                "id": "batch_size_br_rpm_limit_br_min_batch_interval",
                "label": "--batch_size\n--rpm_limit\n--min_batch_interval",
                "color": {
                        "background": "#ffd",
                        "border": "#aa3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "--batch_size<br/>--rpm_limit<br/>--min_batch_interval (command_arguments)",
                "size": 14
        },
        {
                "id": "set_settings",
                "label": "set_settings()",
                "color": {
                        "background": "#7d7",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "set_settings() (core_functions)",
                "size": 30
        },
        {
                "id": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "label": "List of Clinical Cases w/ DDx and Ranks\n(Pydantic Models)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "models_dxGPT_models_py",
                "label": "models/dxGPT_models.py",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "models/dxGPT_models.py (application_components)",
                "size": 20
        },
        {
                "id": "prompts_dxGPT_prompts_py",
                "label": "prompts/dxGPT_prompts.py",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "prompts/dxGPT_prompts.py (application_components)",
                "size": 20
        },
        {
                "id": "Raw_Differential_Diagnosis_br_Extracted_text_block",
                "label": "Raw Differential Diagnosis\n(Extracted text block)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Raw Differential Diagnosis<br/>(Extracted text block) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "Selected_dxGPT_Prompt_br_e_g_StandardDxGPTPrompt",
                "label": "Selected dxGPT Prompt\n(e.g., StandardDxGPTPrompt)",
                "color": {
                        "background": "#ffb",
                        "border": "#b90"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Selected dxGPT Prompt<br/>(e.g., StandardDxGPTPrompt) (selected_components)",
                "size": 18
        },
        {
                "id": "serialization_dxgpt_pydantic_models_py",
                "label": "serialization/dxgpt_pydantic_models.py",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "serialization/dxgpt_pydantic_models.py (application_components)",
                "size": 20
        },
        {
                "id": "Selected_dxGPT_Model_br_e_g_LlamaThreeEightBConfig",
                "label": "Selected dxGPT Model\n(e.g., LlamaThreeEightBConfig)",
                "color": {
                        "background": "#ffb",
                        "border": "#b90"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Selected dxGPT Model<br/>(e.g., LlamaThreeEightBConfig) (selected_components)",
                "size": 18
        },
        {
                "id": "parsers_dxGPT_parsers_py",
                "label": "parsers/dxGPT_parsers.py",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "parsers/dxGPT_parsers.py (application_components)",
                "size": 20
        },
        {
                "id": "Differential_Diagnosis_Parser_br_e_g_parse_top5_xml",
                "label": "Differential Diagnosis Parser\n(e.g., parse_top5_xml)",
                "color": {
                        "background": "#ffb",
                        "border": "#b90"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Differential Diagnosis Parser<br/>(e.g., parse_top5_xml) (selected_components)",
                "size": 18
        },
        {
                "id": "add_differential_diagnosis_to_rank_br_in_post_bench29",
                "label": "add_differential_diagnosis_to_rank()\nin post_bench29",
                "color": {
                        "background": "#fbb",
                        "border": "#d33"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "add_differential_diagnosis_to_rank()<br/>in post_bench29 (database_functions)",
                "size": 20
        },
        {
                "id": "retrieve_and_make_prompts",
                "label": "retrieve_and_make_prompts()",
                "color": {
                        "background": "#7d7",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "retrieve_and_make_prompts() (core_functions)",
                "size": 30
        },
        {
                "id": "run_dxGPT_async_py_br_Command_line_entry",
                "label": "run_dxGPT_async.py\n(Command-line entry)",
                "color": {
                        "background": "#afa",
                        "border": "#3a3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "run_dxGPT_async.py<br/>(Command-line entry) (application_components)",
                "size": 20
        },
        {
                "id": "process_all_batches",
                "label": "process_all_batches()",
                "color": {
                        "background": "#bbf",
                        "border": "#33f"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "process_all_batches() (framework_components)",
                "size": 25
        },
        {
                "id": "Disease_Name_br_String",
                "label": "Disease Name\n(String)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Disease Name<br/>(String) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "LlmDifferentialDiagnosis_br_Raw_responses",
                "label": "LlmDifferentialDiagnosis\n(Raw responses)",
                "color": {
                        "background": "#f9f",
                        "border": "#333"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "LlmDifferentialDiagnosis<br/>(Raw responses) (database_tables)",
                "size": 25
        },
        {
                "id": "get_cases_bench",
                "label": "get_cases_bench()",
                "color": {
                        "background": "#fbb",
                        "border": "#d33"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "get_cases_bench() (database_functions)",
                "size": 20
        },
        {
                "id": "hospital_br_num_samples_br_verbose",
                "label": "--hospital\n--num_samples\n--verbose",
                "color": {
                        "background": "#ffd",
                        "border": "#aa3"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "--hospital<br/>--num_samples<br/>--verbose (command_arguments)",
                "size": 14
        },
        {
                "id": "Rank_Position_br_Integer",
                "label": "Rank Position\n(Integer)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Rank Position<br/>(Integer) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "DifferentialDiagnosis2Rank_br_Structured_diagnoses",
                "label": "DifferentialDiagnosis2Rank\n(Structured diagnoses)",
                "color": {
                        "background": "#f9f",
                        "border": "#333"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "DifferentialDiagnosis2Rank<br/>(Structured diagnoses) (database_tables)",
                "size": 25
        },
        {
                "id": "AsyncModelHandler",
                "label": "AsyncModelHandler",
                "color": {
                        "background": "#bbf",
                        "border": "#33f"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "AsyncModelHandler (framework_components)",
                "size": 25
        },
        {
                "id": "case_bench_id",
                "label": "case_bench_id",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "case_bench_id (data_flow_elements)",
                "size": 12
        },
        {
                "id": "Case_Model_br_Pydantic_Schema",
                "label": "Case Model\n(Pydantic Schema)",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Case Model<br/>(Pydantic Schema) (data_flow_elements)",
                "size": 12
        },
        {
                "id": "case_text",
                "label": "case_text",
                "color": {
                        "background": "#f9f9f9",
                        "border": "#999"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "case_text (data_flow_elements)",
                "size": 12
        },
        {
                "id": "Rank_Parser_br_e_g_universal_dif_diagnosis_parser",
                "label": "Rank Parser\n(e.g., universal_dif_diagnosis_parser)",
                "color": {
                        "background": "#ffb",
                        "border": "#b90"
                },
                "shape": "box",
                "font": {
                        "size": 12,
                        "color": "#000"
                },
                "title": "Rank Parser<br/>(e.g., universal_dif_diagnosis_parser) (selected_components)",
                "size": 18
        }
]);
        var edges = new vis.DataSet([
        {
                "from": "run_dxGPT_async_py_br_Command_line_entry",
                "to": "dxGPT_async_py_br_Main_async_workflow",
                "label": "calls",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "run_dxGPT_async.py<br/>(Command-line entry) calls dxGPT_async.py<br/>(Main async workflow)"
        },
        {
                "from": "dxGPT_async_py_br_Main_async_workflow",
                "to": "set_settings",
                "label": "calls",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "dxGPT_async.py<br/>(Main async workflow) calls set_settings()"
        },
        {
                "from": "dxGPT_async_py_br_Main_async_workflow",
                "to": "retrieve_and_make_prompts",
                "label": "calls",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "dxGPT_async.py<br/>(Main async workflow) calls retrieve_and_make_prompts()"
        },
        {
                "from": "dxGPT_async_py_br_Main_async_workflow",
                "to": "process_results",
                "label": "calls",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "dxGPT_async.py<br/>(Main async workflow) calls process_results()"
        },
        {
                "from": "set_settings",
                "to": "n_1_inits_configuration",
                "label": "produces",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "set_settings() produces 1. inits configuration"
        },
        {
                "from": "n_1_inits_configuration",
                "to": "model_alias",
                "label": "produces",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "1. inits configuration produces --model_alias"
        },
        {
                "from": "n_1_inits_configuration",
                "to": "prompt_alias",
                "label": "produces",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "1. inits configuration produces --prompt_alias"
        },
        {
                "from": "List_of_Clinical_Cases_br_Pydantic_models",
                "to": "process_all_batches",
                "label": "sent to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "List of Clinical Cases<br/>(Pydantic models) sent to process_all_batches()"
        },
        {
                "from": "prompt_alias",
                "to": "prompts_dxGPT_prompts_py",
                "label": "sent to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "--prompt_alias sent to prompts/dxGPT_prompts.py"
        },
        {
                "from": "prompts_dxGPT_prompts_py",
                "to": "Selected_dxGPT_Prompt_br_e_g_StandardDxGPTPrompt",
                "label": "loads",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "prompts/dxGPT_prompts.py loads Selected dxGPT Prompt<br/>(e.g., StandardDxGPTPrompt)"
        },
        {
                "from": "PromptBuilder",
                "to": "Selected_dxGPT_Prompt_br_e_g_StandardDxGPTPrompt",
                "label": "extends",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "PromptBuilder extends Selected dxGPT Prompt<br/>(e.g., StandardDxGPTPrompt)"
        },
        {
                "from": "Selected_dxGPT_Prompt_br_e_g_StandardDxGPTPrompt",
                "to": "process_all_batches",
                "label": "used by",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Selected dxGPT Prompt<br/>(e.g., StandardDxGPTPrompt) used by process_all_batches()"
        },
        {
                "from": "model_alias",
                "to": "process_all_batches",
                "label": "sent to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "--model_alias sent to process_all_batches()"
        },
        {
                "from": "AsyncModelHandler",
                "to": "models_dxGPT_models_py",
                "label": "selects",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "AsyncModelHandler selects models/dxGPT_models.py"
        },
        {
                "from": "models_dxGPT_models_py",
                "to": "Selected_dxGPT_Model_br_e_g_LlamaThreeEightBConfig",
                "label": "loads",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "models/dxGPT_models.py loads Selected dxGPT Model<br/>(e.g., LlamaThreeEightBConfig)"
        },
        {
                "from": "Selected_dxGPT_Model_br_e_g_LlamaThreeEightBConfig",
                "to": "List_of_LLM_responses_br_plain_text",
                "label": "produces",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Selected dxGPT Model<br/>(e.g., LlamaThreeEightBConfig) produces List of LLM responses<br/>(plain text)"
        },
        {
                "from": "batch_size_br_rpm_limit_br_min_batch_interval",
                "to": "process_all_batches",
                "label": "configures",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "--batch_size<br/>--rpm_limit<br/>--min_batch_interval configures process_all_batches()"
        },
        {
                "from": "retrieve_and_make_prompts",
                "to": "hospital_br_num_samples_br_verbose",
                "label": "uses",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "retrieve_and_make_prompts() uses --hospital<br/>--num_samples<br/>--verbose"
        },
        {
                "from": "hospital_br_num_samples_br_verbose",
                "to": "get_cases_bench",
                "label": "sent to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "--hospital<br/>--num_samples<br/>--verbose sent to get_cases_bench()"
        },
        {
                "from": "model_alias",
                "to": "insert_or_fetch_model_br_insert_or_fetch_prompt",
                "label": "sent to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "--model_alias sent to insert_or_fetch_model()<br/>insert_or_fetch_prompt()"
        },
        {
                "from": "prompt_alias",
                "to": "insert_or_fetch_model_br_insert_or_fetch_prompt",
                "label": "sent to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "--prompt_alias sent to insert_or_fetch_model()<br/>insert_or_fetch_prompt()"
        },
        {
                "from": "insert_or_fetch_model_br_insert_or_fetch_prompt",
                "to": "Models_br_LLM_configs",
                "label": "queries",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "insert_or_fetch_model()<br/>insert_or_fetch_prompt() queries Models<br/>(LLM configs)"
        },
        {
                "from": "insert_or_fetch_model_br_insert_or_fetch_prompt",
                "to": "Prompts_br_Templates",
                "label": "queries",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "insert_or_fetch_model()<br/>insert_or_fetch_prompt() queries Prompts<br/>(Templates)"
        },
        {
                "from": "Models_br_LLM_configs",
                "to": "model_id",
                "label": "returns",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Models<br/>(LLM configs) returns model_id"
        },
        {
                "from": "Prompts_br_Templates",
                "to": "prompt_id",
                "label": "returns",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Prompts<br/>(Templates) returns prompt_id"
        },
        {
                "from": "CasesBench_br_Input_cases",
                "to": "case_bench_id",
                "label": "returns",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "CasesBench<br/>(Input cases) returns case_bench_id"
        },
        {
                "from": "CasesBench_br_Input_cases",
                "to": "case_text",
                "label": "returns",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "CasesBench<br/>(Input cases) returns case_text"
        },
        {
                "from": "case_bench_id",
                "to": "Case_Model_br_Pydantic_Schema",
                "label": "part of",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "case_bench_id part of Case Model<br/>(Pydantic Schema)"
        },
        {
                "from": "case_text",
                "to": "Case_Model_br_Pydantic_Schema",
                "label": "part of",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "case_text part of Case Model<br/>(Pydantic Schema)"
        },
        {
                "from": "model_id",
                "to": "Case_Model_br_Pydantic_Schema",
                "label": "part of",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "model_id part of Case Model<br/>(Pydantic Schema)"
        },
        {
                "from": "prompt_id",
                "to": "Case_Model_br_Pydantic_Schema",
                "label": "part of",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "prompt_id part of Case Model<br/>(Pydantic Schema)"
        },
        {
                "from": "Case_Model_br_Pydantic_Schema",
                "to": "List_of_Clinical_Cases_br_Pydantic_models",
                "label": "generates",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Case Model<br/>(Pydantic Schema) generates List of Clinical Cases<br/>(Pydantic models)"
        },
        {
                "from": "get_cases_bench",
                "to": "CasesBench_br_Input_cases",
                "label": "queries",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "get_cases_bench() queries CasesBench<br/>(Input cases)"
        },
        {
                "from": "serialization_dxgpt_pydantic_models_py",
                "to": "Case_Model_br_Pydantic_Schema",
                "label": "stored in",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "serialization/dxgpt_pydantic_models.py stored in Case Model<br/>(Pydantic Schema)"
        },
        {
                "from": "process_all_batches",
                "to": "AsyncModelHandler",
                "label": "calls",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "process_all_batches() calls AsyncModelHandler"
        },
        {
                "from": "process_results",
                "to": "parsers_dxGPT_parsers_py",
                "label": "uses",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "process_results() uses parsers/dxGPT_parsers.py"
        },
        {
                "from": "parsers_dxGPT_parsers_py",
                "to": "Differential_Diagnosis_Parser_br_e_g_parse_top5_xml",
                "label": "contains",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "parsers/dxGPT_parsers.py contains Differential Diagnosis Parser<br/>(e.g., parse_top5_xml)"
        },
        {
                "from": "parsers_dxGPT_parsers_py",
                "to": "Rank_Parser_br_e_g_universal_dif_diagnosis_parser",
                "label": "contains",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "parsers/dxGPT_parsers.py contains Rank Parser<br/>(e.g., universal_dif_diagnosis_parser)"
        },
        {
                "from": "List_of_LLM_responses_br_plain_text",
                "to": "Differential_Diagnosis_Parser_br_e_g_parse_top5_xml",
                "label": "passed to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "List of LLM responses<br/>(plain text) passed to Differential Diagnosis Parser<br/>(e.g., parse_top5_xml)"
        },
        {
                "from": "Differential_Diagnosis_Parser_br_e_g_parse_top5_xml",
                "to": "Raw_Differential_Diagnosis_br_Extracted_text_block",
                "label": "produces",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Differential Diagnosis Parser<br/>(e.g., parse_top5_xml) produces Raw Differential Diagnosis<br/>(Extracted text block)"
        },
        {
                "from": "Raw_Differential_Diagnosis_br_Extracted_text_block",
                "to": "Rank_Parser_br_e_g_universal_dif_diagnosis_parser",
                "label": "input for",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Raw Differential Diagnosis<br/>(Extracted text block) input for Rank Parser<br/>(e.g., universal_dif_diagnosis_parser)"
        },
        {
                "from": "List_of_Clinical_Cases_br_Pydantic_models",
                "to": "List_of_Clinical_Cases_w_DDx_br_Pydantic_Models",
                "label": "augmented to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "List of Clinical Cases<br/>(Pydantic models) augmented to List of Clinical Cases w/ DDx<br/>(Pydantic Models)"
        },
        {
                "from": "Raw_Differential_Diagnosis_br_Extracted_text_block",
                "to": "List_of_Clinical_Cases_w_DDx_br_Pydantic_Models",
                "label": "stored as",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Raw Differential Diagnosis<br/>(Extracted text block) stored as List of Clinical Cases w/ DDx<br/>(Pydantic Models)"
        },
        {
                "from": "List_of_Clinical_Cases_w_DDx_br_Pydantic_Models",
                "to": "add_batch_differential_diagnoses_br_in_dxGPT_queries",
                "label": "sent to DB via",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "List of Clinical Cases w/ DDx<br/>(Pydantic Models) sent to DB via add_batch_differential_diagnoses()<br/>in dxGPT_queries"
        },
        {
                "from": "List_of_Clinical_Cases_w_DDx_br_Pydantic_Models",
                "to": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "label": "augmented to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "List of Clinical Cases w/ DDx<br/>(Pydantic Models) augmented to List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models)"
        },
        {
                "from": "Rank_Parser_br_e_g_universal_dif_diagnosis_parser",
                "to": "Rank_Position_br_Integer",
                "label": "extracts",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Rank Parser<br/>(e.g., universal_dif_diagnosis_parser) extracts Rank Position<br/>(Integer)"
        },
        {
                "from": "Rank_Parser_br_e_g_universal_dif_diagnosis_parser",
                "to": "Disease_Name_br_String",
                "label": "extracts",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Rank Parser<br/>(e.g., universal_dif_diagnosis_parser) extracts Disease Name<br/>(String)"
        },
        {
                "from": "Rank_Parser_br_e_g_universal_dif_diagnosis_parser",
                "to": "Reasoning_br_String",
                "label": "extracts",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Rank Parser<br/>(e.g., universal_dif_diagnosis_parser) extracts Reasoning<br/>(String)"
        },
        {
                "from": "dxGPT_async_py_br_Main_async_workflow",
                "to": "queries_dxGPT_queries_py_br_Database_operations",
                "label": "uses",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "dxGPT_async.py<br/>(Main async workflow) uses queries/dxGPT_queries.py<br/>(Database operations)"
        },
        {
                "from": "queries_dxGPT_queries_py_br_Database_operations",
                "to": "add_batch_differential_diagnoses_br_in_dxGPT_queries",
                "label": "calls",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "queries/dxGPT_queries.py<br/>(Database operations) calls add_batch_differential_diagnoses()<br/>in dxGPT_queries"
        },
        {
                "from": "queries_dxGPT_queries_py_br_Database_operations",
                "to": "add_differential_diagnosis_to_rank_br_in_post_bench29",
                "label": "contains",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "queries/dxGPT_queries.py<br/>(Database operations) contains add_differential_diagnosis_to_rank()<br/>in post_bench29"
        },
        {
                "from": "add_batch_differential_diagnoses_br_in_dxGPT_queries",
                "to": "Differential_Diagnosis_ID",
                "label": "generates",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "add_batch_differential_diagnoses()<br/>in dxGPT_queries generates Differential Diagnosis ID"
        },
        {
                "from": "add_batch_differential_diagnoses_br_in_dxGPT_queries",
                "to": "LlmDifferentialDiagnosis_br_Raw_responses",
                "label": "writes to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "add_batch_differential_diagnoses()<br/>in dxGPT_queries writes to LlmDifferentialDiagnosis<br/>(Raw responses)"
        },
        {
                "from": "Rank_Position_br_Integer",
                "to": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "label": "stored in",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Rank Position<br/>(Integer) stored in List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models)"
        },
        {
                "from": "Disease_Name_br_String",
                "to": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "label": "stored in",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Disease Name<br/>(String) stored in List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models)"
        },
        {
                "from": "Reasoning_br_String",
                "to": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "label": "stored in",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Reasoning<br/>(String) stored in List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models)"
        },
        {
                "from": "Differential_Diagnosis_ID",
                "to": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "label": "stored in",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "Differential Diagnosis ID stored in List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models)"
        },
        {
                "from": "List_of_Clinical_Cases_w_DDx_and_Ranks_br_Pydantic_Models",
                "to": "add_differential_diagnosis_to_rank_br_in_post_bench29",
                "label": "sent to DB via",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "List of Clinical Cases w/ DDx and Ranks<br/>(Pydantic Models) sent to DB via add_differential_diagnosis_to_rank()<br/>in post_bench29"
        },
        {
                "from": "add_differential_diagnosis_to_rank_br_in_post_bench29",
                "to": "DifferentialDiagnosis2Rank_br_Structured_diagnoses",
                "label": "writes to",
                "arrows": "to",
                "font": {
                        "size": 10,
                        "color": "#333"
                },
                "color": {
                        "color": "#666"
                },
                "width": 2,
                "smooth": {
                        "type": "continuous"
                },
                "title": "add_differential_diagnosis_to_rank()<br/>in post_bench29 writes to DifferentialDiagnosis2Rank<br/>(Structured diagnoses)"
        }
]);
        var data = {
            nodes: nodes,
            edges: edges
        };

        // Initial network options
        var options = {
            physics: {
                enabled: true,
                forceAtlas2Based: {
                    theta: 0.5,
                    gravitationalConstant: -50,
                    centralGravity: 0.3,
                    springConstant: 0.08,
                    springLength: 100,
                    damping: 0.09,
                    avoidOverlap: 0.1
                },
                maxVelocity: 50,
                minVelocity: 0.1,
                solver: 'forceAtlas2Based',
                stabilization: {
                    enabled: true,
                    iterations: 1000,
                    updateInterval: 25
                }
            },
            layout: {
                randomSeed: 2
            },
            interaction: {
                dragNodes: true,
                dragView: true,
                zoomView: true,
                selectConnectedEdges: true,
                hover: true,
                hoverConnectedEdges: true,
                tooltipDelay: 300,
                navigationButtons: false,
                keyboard: {
                    enabled: true,
                    speed: {x: 10, y: 10, zoom: 0.02},
                    bindToWindow: false
                }
            },
            nodes: {
                borderWidth: 2,
                shadow: {
                    enabled: true,
                    color: 'rgba(0,0,0,0.2)',
                    size: 5,
                    x: 2,
                    y: 2
                },
                font: {
                    size: 12,
                    color: '#000000'
                },
                chosen: {
                    node: true,
                    label: true
                }
            },
            edges: {
                arrows: {
                    to: {
                        enabled: true,
                        scaleFactor: 0.5
                    }
                },
                shadow: {
                    enabled: true,
                    color: 'rgba(0,0,0,0.1)',
                    size: 2,
                    x: 1,
                    y: 1
                },
                smooth: {
                    type: 'continuous',
                    forceDirection: 'none',
                    roundness: 0.5
                },
                color: {
                    color: '#848484',
                    highlight: '#ff0000',
                    hover: '#ff8800'
                }
            }
        };

        // Initialize network
        var container = document.getElementById('network');
        var network = new vis.Network(container, data, options);
        var physicsEnabled = true;

        // Event handlers
        network.on('click', function(params) {
            if (params.nodes.length > 0) {
                var nodeId = params.nodes[0];
                var node = nodes.get(nodeId);
                console.log('Clicked node:', node);
            }
        });

        network.on('hoverNode', function(params) {
            container.style.cursor = 'pointer';
        });

        network.on('blurNode', function(params) {
            container.style.cursor = 'grab';
        });

        network.on('dragStart', function(params) {
            container.style.cursor = 'grabbing';
        });

        network.on('dragEnd', function(params) {
            container.style.cursor = 'grab';
        });

        // Control functions
        function fitNetwork() {
            network.fit({
                animation: {
                    duration: 1000,
                    easingFunction: 'easeInOutQuad'
                }
            });
        }

        function resetZoom() {
            network.moveTo({
                position: {x: 0, y: 0},
                scale: 1,
                animation: {
                    duration: 1000,
                    easingFunction: 'easeInOutQuad'
                }
            });
        }

        function centerNetwork() {
            var positions = network.getPositions();
            var nodeIds = Object.keys(positions);
            if (nodeIds.length > 0) {
                var avgX = 0, avgY = 0;
                nodeIds.forEach(function(nodeId) {
                    avgX += positions[nodeId].x;
                    avgY += positions[nodeId].y;
                });
                avgX /= nodeIds.length;
                avgY /= nodeIds.length;
                
                network.moveTo({
                    position: {x: avgX, y: avgY},
                    animation: {
                        duration: 1000,
                        easingFunction: 'easeInOutQuad'
                    }
                });
            }
        }

        function zoomIn() {
            var scale = network.getScale() * 1.2;
            network.moveTo({scale: scale});
        }

        function zoomOut() {
            var scale = network.getScale() / 1.2;
            network.moveTo({scale: scale});
        }

        function togglePhysics() {
            physicsEnabled = !physicsEnabled;
            network.setOptions({physics: {enabled: physicsEnabled}});
            
            var button = document.getElementById('physics-toggle');
            var statusSpan = document.getElementById('physics-state');
            
            if (physicsEnabled) {
                button.textContent = '‚ö° Physics ON';
                button.classList.add('active');
                statusSpan.textContent = 'Enabled';
            } else {
                button.textContent = '‚ö° Physics OFF';
                button.classList.remove('active');
                statusSpan.textContent = 'Disabled';
            }
        }

        // Physics parameter controls
        function updatePhysicsParameter(param, value) {
            var currentOptions = network.getOptionsFromConfigurator();
            
            switch(param) {
                case 'gravity':
                    network.setOptions({
                        physics: {
                            forceAtlas2Based: {centralGravity: parseFloat(value)},
                            barnesHut: {centralGravity: parseFloat(value)},
                            repulsion: {centralGravity: parseFloat(value)}
                        }
                    });
                    break;
                case 'springLength':
                    network.setOptions({
                        physics: {
                            forceAtlas2Based: {springLength: parseInt(value)},
                            barnesHut: {springLength: parseInt(value)},
                            repulsion: {springLength: parseInt(value)}
                        }
                    });
                    break;
                case 'springConstant':
                    network.setOptions({
                        physics: {
                            forceAtlas2Based: {springConstant: parseFloat(value)},
                            barnesHut: {springConstant: parseFloat(value)},
                            repulsion: {springConstant: parseFloat(value)}
                        }
                    });
                    break;
                case 'nodeDistance':
                    network.setOptions({
                        physics: {
                            barnesHut: {avoidOverlap: parseInt(value)/1000},
                            repulsion: {nodeDistance: parseInt(value)}
                        }
                    });
                    break;
                case 'damping':
                    network.setOptions({
                        physics: {
                            forceAtlas2Based: {damping: parseFloat(value)},
                            barnesHut: {damping: parseFloat(value)},
                            repulsion: {damping: parseFloat(value)}
                        }
                    });
                    break;
            }
        }

        // Set up slider controls
        function setupSliderControl(sliderId, valueId, param) {
            var slider = document.getElementById(sliderId);
            var valueInput = document.getElementById(valueId);
            
            slider.addEventListener('input', function() {
                valueInput.value = slider.value;
                updatePhysicsParameter(param, slider.value);
            });
            
            valueInput.addEventListener('input', function() {
                slider.value = valueInput.value;
                updatePhysicsParameter(param, valueInput.value);
            });
        }

        // Initialize slider controls
        setupSliderControl('gravity-slider', 'gravity-value', 'gravity');
        setupSliderControl('spring-length-slider', 'spring-length-value', 'springLength');
        setupSliderControl('spring-constant-slider', 'spring-constant-value', 'springConstant');
        setupSliderControl('node-distance-slider', 'node-distance-value', 'nodeDistance');
        setupSliderControl('damping-slider', 'damping-value', 'damping');

        // Layout selector
        document.getElementById('layout-select').addEventListener('change', function(e) {
            var layoutType = e.target.value;
            var newOptions = {...options};
            
            if (layoutType === 'hierarchicalUD') {
                newOptions.layout = {
                    hierarchical: {
                        enabled: true,
                        levelSeparation: 150,
                        nodeSpacing: 100,
                        treeSpacing: 200,
                        blockShifting: true,
                        edgeMinimization: true,
                        parentCentralization: true,
                        direction: 'UD',
                        sortMethod: 'directed'
                    }
                };
                newOptions.physics.solver = 'hierarchicalRepulsion';
            } else if (layoutType === 'hierarchicalLR') {
                newOptions.layout = {
                    hierarchical: {
                        enabled: true,
                        levelSeparation: 150,
                        nodeSpacing: 100,
                        treeSpacing: 200,
                        blockShifting: true,
                        edgeMinimization: true,
                        parentCentralization: true,
                        direction: 'LR',
                        sortMethod: 'directed'
                    }
                };
                newOptions.physics.solver = 'hierarchicalRepulsion';
            } else {
                newOptions.layout = {randomSeed: 2};
                newOptions.physics.solver = layoutType;
            }
            
            network.setOptions(newOptions);
            document.getElementById('solver-select').value = newOptions.physics.solver;
        });

        // Solver selector
        document.getElementById('solver-select').addEventListener('change', function(e) {
            var solver = e.target.value;
            network.setOptions({
                physics: {
                    solver: solver
                }
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.target.tagName.toLowerCase() === 'input') return;
            
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    togglePhysics();
                    break;
                case 'f':
                    e.preventDefault();
                    fitNetwork();
                    break;
                case 'r':
                    e.preventDefault();
                    resetZoom();
                    break;
                case 'c':
                    e.preventDefault();
                    centerNetwork();
                    break;
            }
        });

        // Initial setup
        setTimeout(function() {
            fitNetwork();
            // Set default physics button state
            document.getElementById('physics-toggle').classList.add('active');
        }, 1000);

        // Set cursor styles
        container.style.cursor = 'grab';
    </script>
</body>
</html>